<html>
  <head>
    <title>Routes Staging App Redirect</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <script>
      document.addEventListener("DOMContentLoaded", function (event) {
        var link = document.getElementById("link");

        var baseUri = "";
        const url = document.location.search;
        // Take the uri from the params
        var qs = decodeURIComponent(document.location.search);
        console.log({ qs, url: document.location });
        if (qs) {
          const spl = qs.split("?")[0] + "?";
          let extractedRedirect = qs.replace(spl, "");
          baseUri = extractedRedirect;
        }
        if (baseUri) {
          // Update the link urls
          link.href = baseUri;
          window.location = baseUri;
        }
        const redirectInterval = setInterval(() => {
          var countdown = document.querySelector(".countdown");
          var t = parseInt(countdown.innerText, 10);
          t -= 1;
          countdown.innerText = t;
        }, 1000);
        setTimeout(function () {
          window.location = "https://routes.life";
          clearInterval(redirectInterval);
        }, 5000);
      });
    </script>
  </head>

  <body>
    <p>
      Redirecting in
      <span class="countdown">5</span> seconds
    </p>
    <a id="link"></a>
  </body>
</html>
